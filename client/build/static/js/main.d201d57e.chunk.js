(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{208:function(e,t,n){},218:function(e,t,n){},219:function(e,t,n){"use strict";n.r(t);var a=n(76),c=n.n(a),s=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,262)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,s=t.getLCP,r=t.getTTFB;n(e),a(e),c(e),s(e),r(e)}))},r=n(0),o=n(187),i=n(247),l=n(251),j=n(244),b=n(190),u=n(30),d=n(16),m=(n(207),n(243)),O=(n(208),n(15)),h=n(38),p=n(181),x=n(3),g={user:null};if(localStorage.getItem("jwtToken")){var f=Object(p.a)(localStorage.getItem("jwtToken"));1e3*f.exp<Date.now()?localStorage.removeItem("jwtToken"):g.user=f}var v=Object(r.createContext)({user:null,login:function(e){},logout:function(){}});function C(e,t){switch(t.type){case"LOGIN":return Object(h.a)(Object(h.a)({},e),{},{user:t.payload});case"LOGOUT":return Object(h.a)(Object(h.a)({},e),{},{user:null});default:return e}}function y(e){var t=Object(r.useReducer)(C,g),n=Object(O.a)(t,2),a=n[0],c=n[1];return Object(x.jsx)(v.Provider,Object(h.a)({value:{user:a.user,login:function(e){localStorage.setItem("jwtToken",e.token),c({type:"LOGIN",payload:e})},logout:function(){localStorage.removeItem("jwtToken"),c({type:"LOGOUT"})}}},e))}var I=n(191),w=["component"];var k=function(e){var t=e.component,n=Object(I.a)(e,w),a=Object(r.useContext)(v).user;return Object(x.jsx)(d.b,Object(h.a)(Object(h.a)({},n),{},{render:function(e){return a?Object(x.jsx)(d.a,{to:"/"}):Object(x.jsx)(t,Object(h.a)({},e))}}))},P=n(249);var S=function(){var e=Object(r.useContext)(v),t=e.user,n=e.logout,a=window.location.pathname,c="/"===a?"home":a.substr(1),s=Object(r.useState)(c),o=Object(O.a)(s,2),i=o[0],l=o[1],j=function(e,t){var n=t.name;return l(n)};return t?Object(x.jsxs)(P.a,{pointing:!0,secondary:!0,floated:"right",size:"massive",color:"teal",children:[Object(x.jsx)(P.a.Item,{name:t.username,active:!0,as:u.b,to:"/"}),Object(x.jsx)(P.a.Menu,{position:"right",children:Object(x.jsx)(P.a.Item,{style:{color:"white"},name:"logout",onClick:n,as:u.b,to:"/"})})]}):Object(x.jsxs)(P.a,{pointing:!0,secondary:!0,floated:"right",size:"massive",color:"teal",children:[Object(x.jsx)(P.a.Item,{className:"",name:"home",active:"home"===i,onClick:j,as:u.b,to:"/"}),Object(x.jsxs)(P.a.Menu,{position:"right",children:[Object(x.jsx)(P.a.Item,{name:"login",active:"login"===i,onClick:j,as:u.b,to:"/login"}),Object(x.jsx)(P.a.Item,{name:"register",active:"register"===i,onClick:j,as:u.b,to:"/register"})]})]})},$=n(255),N=n(257),A=n(250),D=n(253),L=n(254),E=n(107),z=n(146),F=n(113),T=n.n(F),Q=n(28),U=n(260),q=n(248),M=n(245);var R,B=function(e){var t=e.content,n=e.children;return Object(x.jsx)(M.a,{inverted:!0,content:t,trigger:n})};var G,H,J,V=Object(q.a)(R||(R=Object(Q.a)(["\n  mutation likePost($postId: ID!) {\n    likePost(postId: $postId) {\n      id\n      likes {\n        id\n        username\n      }\n      likeCount\n    }\n  }\n"]))),W=function(e){var t=e.user,n=e.post,a=n.id,c=n.likeCount,s=n.likes,o=Object(r.useState)(!1),i=Object(O.a)(o,2),l=i[0],j=i[1];Object(r.useEffect)((function(){t&&s.find((function(e){return e.username===t.username}))?j(!0):j(!1)}),[t,s]);var b=Object(U.a)(V,{variables:{postId:a}}),d=Object(O.a)(b,1)[0],m=t?l?Object(x.jsx)(L.a,{color:"teal",children:Object(x.jsx)(E.a,{name:"heart"})}):Object(x.jsx)(L.a,{color:"teal",basic:!0,children:Object(x.jsx)(E.a,{name:"heart"})}):Object(x.jsx)(L.a,{as:u.b,to:"/login",color:"teal",basic:!0,children:Object(x.jsx)(E.a,{name:"heart"})});return t?Object(x.jsxs)(L.a,{as:"div",labelPosition:"right",onClick:d,children:[Object(x.jsx)(B,{content:l?"Unlike":"Like",children:m}),Object(x.jsx)(z.a,{basic:!0,color:"teal",pointing:"left",children:c})]}):Object(x.jsxs)(L.a,{as:"div",labelPosition:"right",children:[Object(x.jsx)(B,{content:l?"Unlike":"Like",children:m}),Object(x.jsx)(z.a,{basic:!0,color:"blue",pointing:"left",children:c})]})},Y=n(145),K=n(252),X=Object(q.a)(G||(G=Object(Q.a)(["\n  {\n    getPosts {\n      id\n      body\n      createdAt\n      username\n      likeCount\n      likes {\n        username\n      }\n      comments {\n        id\n        username\n        createdAt\n        body\n      }\n      commentCount\n    }\n  }\n"])));var Z=Object(q.a)(H||(H=Object(Q.a)(["\n  mutation deletePost($postId: ID!) {\n    deletePost(postId: $postId)\n  }\n"]))),_=Object(q.a)(J||(J=Object(Q.a)(["\n  mutation deleteComment($postId: ID!, $commentId: ID!) {\n    deleteComment(postId: $postId, commentId: $commentId) {\n      id\n      comments {\n        id\n        username\n        createdAt\n        body\n      }\n      commentCount\n    }\n  }\n"]))),ee=function(e){var t=e.postId,n=e.commentId,a=e.callback,c=Object(r.useState)(!1),s=Object(O.a)(c,2),o=s[0],i=s[1],l=n?_:Z,j=Object(U.a)(l,{update:function(e,t){if(i(!1),!n){var c=e.readQuery({query:X}),s=[t.data].concat(Object(Y.a)(c.getPosts));e.writeQuery({query:X,data:{getPosts:s}})}a&&a()},variables:{postId:t,commentId:n},onError:function(e){return e}}),b=Object(O.a)(j,1)[0];return Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(B,{content:n?"Delete this comment":"Delete this post",children:Object(x.jsx)(L.a,{as:"div",color:"red",floated:"right",onClick:function(){return i(!0)},children:Object(x.jsx)(E.a,{name:"trash",style:{margin:0}})})}),Object(x.jsx)(K.a,{open:o,onCancel:function(){return i(!1)},onConfirm:b})]})};var te,ne=function(e){var t,n=e.post,a=n.body,c=n.createdAt,s=n.id,o=n.username,i=n.likeCount,l=n.commentCount,j=n.likes,b=Object(r.useContext)(v).user;return Object(x.jsxs)(D.a,{className:"post-card",fluid:!0,children:[Object(x.jsxs)(D.a.Content,{children:[Object(x.jsx)(D.a.Header,{children:(t=o,t.charAt(0).toUpperCase()+t.slice(1))}),Object(x.jsx)(D.a.Meta,{children:T()(c).fromNow()}),Object(x.jsx)(D.a.Description,{children:a})]}),Object(x.jsxs)(D.a.Content,{extra:!0,children:[Object(x.jsx)(W,{user:b,post:{id:s,likes:j,likeCount:i}}),Object(x.jsx)(B,{content:"comment on this post",children:Object(x.jsxs)(L.a,{labelPosition:"right",as:u.b,to:"/posts/".concat(s),children:[Object(x.jsx)(L.a,{color:"blue",basic:!0,children:Object(x.jsx)(E.a,{name:"comments"})}),Object(x.jsx)(z.a,{basic:!0,color:"blue",pointing:"left",children:l})]})}),b&&b.username===o&&Object(x.jsx)(ee,{postId:s})]})]})},ae=n(246),ce=n(120),se=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Object(r.useState)(t),a=Object(O.a)(n,2),c=a[0],s=a[1],o=function(e){s(Object(h.a)(Object(h.a)({},c),{},Object(ce.a)({},e.target.name,e.target.value)))},i=function(t){t.preventDefault(),e()};return{onChange:o,onSubmit:i,values:c}};var re=Object(q.a)(te||(te=Object(Q.a)(["\n    mutation createPost($body: String!) {\n        createPost(body: $body) {\n            id\n            body\n            createdAt\n            username\n            likeCount\n            likes {\n                id\n                username\n                createdAt\n            }\n            commentCount\n            comments {\n                id\n                body\n                username\n                createdAt\n            }\n        }\n    }\n"]))),oe=function(){var e=se((function(){r()}),{body:""}),t=e.values,n=e.onChange,a=e.onSubmit,c=Object(U.a)(re,{variables:t,update:function(e,n){var a=e.readQuery({query:X});e.writeQuery({query:X,data:{getPosts:[n.data.createPost].concat(Object(Y.a)(a.getPosts))}}),t.body=""},onError:function(e){return e}}),s=Object(O.a)(c,2),r=s[0],o=s[1].error;return Object(x.jsxs)(x.Fragment,{children:[Object(x.jsxs)(ae.a,{onSubmit:a,children:[Object(x.jsx)("h2",{style:{color:"#EBEAE2",fontFamily:"cursive",textAlign:"center"},children:"What is on your mind"}),Object(x.jsxs)(ae.a.Field,{children:[Object(x.jsx)(ae.a.Input,{name:"body",onChange:n,value:t.body,error:!!o}),Object(x.jsx)(L.a,{className:"btn-submit",type:"submit",color:"purple",children:"Submit"})]})]}),o&&Object(x.jsx)("div",{className:"ui error message",children:Object(x.jsx)("ul",{className:"list",children:Object(x.jsx)("li",{children:o.graphQLErrors[0].extensions.errors.post})})})]})};n(218);var ie,le=function(){var e=Object($.a)(X),t=e.loading,n=e.data,a=Object(r.useContext)(v).user;return Object(x.jsxs)(N.a,{columns:3,children:[Object(x.jsx)(N.a.Row,{className:"page-title",style:{width:"100%"}}),Object(x.jsxs)(N.a.Row,{children:[a&&Object(x.jsx)(N.a.Column,{children:Object(x.jsx)(oe,{})}),t?Object(x.jsx)("h1",{children:"Loading posts..."}):Object(x.jsx)(A.a.Group,{children:n.getPosts&&n.getPosts.map((function(e){return Object(x.jsx)(N.a.Column,{style:{marginBottom:40},children:Object(x.jsx)(ne,{post:e})},e.id)}))})]})]})},je=n(258);var be,ue=Object(q.a)(ie||(ie=Object(Q.a)(["\n  mutation login($username: String!, $password: String!) {\n    login(username: $username, password: $password) {\n      id\n      email\n      username\n      createdAt\n      token\n    }\n  }\n"]))),de=function(e){var t=Object(r.useContext)(v),n=Object(r.useState)({}),a=Object(O.a)(n,2),c=a[0],s=a[1],o=se((function(){d()}),{username:"",password:""}),i=o.onChange,l=o.onSubmit,j=o.values,b=Object(U.a)(ue,{update:function(n,a){var c=a.data.login;t.login(c),e.history.push("/")},onError:function(e){s(e.graphQLErrors[0].extensions.exception.errors)},variables:j}),u=Object(O.a)(b,2),d=u[0],m=u[1].loading;return Object(x.jsxs)("div",{className:"form-container",children:[Object(x.jsx)("div",{className:"space"}),Object(x.jsx)(je.a,{as:"h2",color:"purple",textAlign:"center",children:"Log-in to your account"}),Object(x.jsxs)(ae.a,{onSubmit:l,noValidate:!0,className:m?"loading":"",children:[Object(x.jsx)(ae.a.Input,{type:"text",placeholder:"Username...",name:"username",size:"big",value:j.username,error:!!c.username,onChange:i}),Object(x.jsx)(ae.a.Input,{type:"password",placeholder:"Password...",name:"password",size:"big",value:j.password,error:!!c.password,onChange:i}),Object(x.jsx)(L.a,{style:{width:"100%"},type:"submit",color:"purple",size:"big",children:"Login"})]}),Object.keys(c).length>0&&Object(x.jsx)("div",{className:"ui error message",children:Object(x.jsx)("ul",{className:"list",children:Object.values(c).map((function(e){return Object(x.jsx)("li",{children:e},e)}))})})]})};var me,Oe,he=Object(q.a)(be||(be=Object(Q.a)(["\n  mutation register($username: String!, $email: String!, $password: String!, $confirmPassword: String!) {\n    register(\n      registerInput: { username: $username, email: $email, password: $password, confirmPassword: $confirmPassword }\n    ) {\n      id\n      email\n      username\n      createdAt\n      token\n    }\n  }\n"]))),pe=function(e){var t=Object(r.useContext)(v),n=Object(r.useState)({}),a=Object(O.a)(n,2),c=a[0],s=a[1],o=se((function(){d()}),{username:"",email:"",password:"",confirmPassword:""}),i=o.onChange,l=o.onSubmit,j=o.values,b=Object(U.a)(he,{update:function(n,a){var c=a.data.register;t.login(c),e.history.push("/")},onError:function(e){s(e.graphQLErrors[0].extensions.exception.errors)},variables:j}),u=Object(O.a)(b,2),d=u[0],m=u[1].loading;return Object(x.jsxs)("div",{className:"form-container",children:[Object(x.jsx)("div",{className:"space"}),Object(x.jsx)(je.a,{as:"h2",color:"purple",textAlign:"center",children:"Resister your account"}),Object(x.jsxs)(ae.a,{onSubmit:l,noValidate:!0,className:m?"loading":"",children:[Object(x.jsx)(ae.a.Input,{type:"text",placeholder:"Username...",name:"username",size:"big",value:j.username,error:!!c.username,onChange:i}),Object(x.jsx)(ae.a.Input,{type:"email",placeholder:"Email...",name:"email",size:"big",value:j.email,error:!!c.email,onChange:i}),Object(x.jsx)(ae.a.Input,{type:"password",placeholder:"Password...",name:"password",size:"big",value:j.password,error:!!c.password,onChange:i}),Object(x.jsx)(ae.a.Input,{type:"password",placeholder:"Confirm Password...",name:"confirmPassword",size:"big",value:j.confirmPassword,error:!!c.confirmPassword,onChange:i}),Object(x.jsx)(L.a,{style:{width:"100%"},type:"submit",color:"purple",size:"big",children:"Register"})]}),Object.keys(c).length>0&&Object(x.jsx)("div",{className:"ui error message",children:Object(x.jsx)("ul",{className:"list",children:Object.values(c).map((function(e){return Object(x.jsx)("li",{children:e},e)}))})})]})};var xe=Object(q.a)(me||(me=Object(Q.a)(["\n  mutation($postId: ID!, $body: String!) {\n    createComment(postId: $postId, body: $body) {\n      id\n      comments {\n        id\n        body\n        createdAt\n        username\n      }\n      commentCount\n    }\n  }\n"]))),ge=Object(q.a)(Oe||(Oe=Object(Q.a)(["\n  query($postId: ID!) {\n    getPost(postId: $postId) {\n      id\n      body\n      createdAt\n      username\n      likeCount\n      likes {\n        username\n      }\n      commentCount\n      comments {\n        id\n        username\n        createdAt\n        body\n      }\n    }\n  }\n"]))),fe=function(e){var t,n=e.match.params.postId,a=Object(r.useContext)(v).user,c=Object(r.useState)(""),s=Object(O.a)(c,2),o=s[0],i=s[1],l=Object($.a)(ge,{variables:{postId:n}}),j=l.loading,b=l.data,d=Object(U.a)(xe,{update:function(){i("")},variables:{postId:n,body:o}}),m=Object(O.a)(d,1)[0];if(j)t=Object(x.jsx)("p",{children:"Loading post..."});else{var h=b.getPost,p=h.id,g=h.body,f=h.createdAt,C=h.username,y=h.likes,I=h.comments,w=h.likeCount,k=h.commentCount;t=Object(x.jsx)(N.a,{children:Object(x.jsxs)(N.a.Row,{children:[Object(x.jsx)(N.a.Column,{width:2}),Object(x.jsxs)(N.a.Column,{width:10,children:[Object(x.jsxs)(D.a,{className:"single-card",fluid:!0,children:[Object(x.jsxs)(D.a.Content,{children:[Object(x.jsx)(D.a.Header,{children:C}),Object(x.jsx)(D.a.Meta,{children:T()(f).fromNow()}),Object(x.jsx)(D.a.Description,{children:g})]}),Object(x.jsx)("hr",{}),Object(x.jsxs)(D.a.Content,{extra:!0,children:[Object(x.jsx)(W,{user:a,post:{id:p,likeCount:w,likes:y}}),Object(x.jsx)(B,{content:"Comment on this post",children:Object(x.jsxs)(L.a,{as:u.b,labelPosition:"right",to:"/Login",children:[Object(x.jsx)(L.a,{basic:!0,color:"blue",children:Object(x.jsx)(E.a,{name:"comments"})}),Object(x.jsx)(z.a,{basic:!0,color:"blue",pointing:"left",children:k})]})}),a&&a.username===C&&Object(x.jsx)(ee,{postId:p,callback:function(){e.history.push("/")}})]})]}),a&&Object(x.jsx)(D.a,{fluid:!0,children:Object(x.jsxs)(D.a.Content,{children:[Object(x.jsx)("p",{children:"Post a Comment"}),Object(x.jsx)(ae.a,{children:Object(x.jsxs)("div",{className:"ui action input fluid",children:[Object(x.jsx)("input",{type:"text",placeholder:"Comment...",name:"comment",value:o,onChange:function(e){return i(e.target.value)}}),Object(x.jsx)("button",{type:"submit",className:"ui button teal",disabled:""===o.trim(""),onClick:m,children:"Submit"})]})})]})}),I.map((function(e){return Object(x.jsx)(D.a,{fluid:!0,children:Object(x.jsxs)(D.a.Content,{children:[a&&a.username===e.username&&Object(x.jsx)(ee,{postId:p,commentId:e.id}),Object(x.jsx)(D.a.Header,{children:e.username}),Object(x.jsx)(D.a.Meta,{children:T()(e.createdAt).fromNow()}),Object(x.jsx)(D.a.Description,{children:e.body})]})},e.id)}))]})]})})}return t};function ve(){return Object(x.jsx)("div",{children:Object(x.jsxs)("p",{style:{textAlign:"center",color:"#AC9FC4"},children:["Andrew Q ",Ce("-")," \u2665 \xa9"]})})}function Ce(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=new Date,n=t.getDate(),a=t.getMonth()+1,c=t.getFullYear();return"".concat(c).concat(e).concat(a<10?"0".concat(a):"".concat(a)).concat(e).concat(n)}function ye(){return Object(x.jsx)("div",{className:"ui small image"})}var Ie=function(){return Object(x.jsxs)(y,{children:[Object(x.jsx)(u.a,{children:Object(x.jsxs)(m.a,{className:"container",children:[Object(x.jsx)(ye,{}),Object(x.jsx)(S,{}),Object(x.jsx)(d.b,{exact:!0,path:"/",component:le}),Object(x.jsx)(k,{exact:!0,path:"/login",component:de}),Object(x.jsx)(k,{exact:!0,path:"/register",component:pe}),Object(x.jsx)(d.b,{exact:!0,path:"/posts/:postId",component:fe})]})}),Object(x.jsx)(ve,{className:"footer"})]})},we=Object(o.a)({uri:"http://localhost:8008/graphql"}),ke=Object(b.a)((function(){var e=localStorage.getItem("jwtToken");return{headers:{Authorization:e?"Bearer ".concat(e):""}}})),Pe=new i.a({link:ke.concat(we),cache:new l.a}),Se=Object(x.jsx)(j.a,{client:Pe,children:Object(x.jsx)(Ie,{})});c.a.render(Se,document.getElementById("root")),s()}},[[219,1,2]]]);
//# sourceMappingURL=main.d201d57e.chunk.js.map